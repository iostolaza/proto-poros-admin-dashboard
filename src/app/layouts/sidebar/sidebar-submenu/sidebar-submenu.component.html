<!-- Recursive submenu with animation, matching lannodev. -->
<!-- Lucide plus/minus. -->
<!-- References: lannodev repo https://github.com/lannodev/angular-tailwind/blob/main/src/app/modules/layout/components/sidebar/sidebar-submenu.component.html -->

<div
  class="max-h-0 overflow-hidden pt-1 transition-all duration-500 ltr:pl-4 rtl:pr-4"
  [ngClass]="{ hidden: !menuService.showSideBar, 'max-h-screen': submenu.expanded }"
>
  <ul
    class="border-border text-muted-foreground flex flex-col border-dashed ltr:border-l ltr:pl-2 rtl:border-r rtl:pr-2"
  >
    <li *ngFor="let sub of submenu.children">
      <div class="text-muted-foreground hover:text-primary relative flex" (click)="toggleMenu(sub)">
        <ng-container
          [ngTemplateOutlet]="sub.children ? childMenu : parentMenu"
          [ngTemplateOutletContext]="{ sub: sub }"
        ></ng-container>

        <ng-template #parentMenu let-sub="sub">
          <a
            *ngIf="sub.route !== '/logout'"
            [routerLink]="sub.route"
            routerLinkActive="text-primary"
            class="text-muted-foreground hover:text-primary flex h-9 cursor-pointer items-center justify-start rounded-sm truncate text-xs font-semibold tracking-wide"
            [ngClass]="{ hidden: !menuService.showSideBar }"
          >
            {{ sub.label }}
          </a>
          <button
            *ngIf="sub.route === '/logout'"
            (click)="menuService.logout()"
            class="text-muted-foreground hover:text-primary flex h-9 cursor-pointer items-center justify-start rounded-sm truncate text-xs font-semibold tracking-wide"
            [ngClass]="{ hidden: !menuService.showSideBar }"
          >
            {{ sub.label }}
          </button>
        </ng-template>

        <ng-template #childMenu let-sub="sub">
          <span class="inline-block w-full cursor-pointer px-4 py-2 text-xs">
            {{ sub.label }}
          </span>
          <button
            [ngClass]="{ hidden: !menuService.showSideBar }"
            class="text-foreground/50 flex cursor-pointer items-center justify-end px-2 transition-all duration-500"
          >
            <svg-icon
              [src]="!sub.expanded ? '/assets/icons/lucide/plus.svg' : '/assets/icons/lucide/minus.svg'"
              [svgClass]="'h-4 w-4'"
            ></svg-icon>
          </button>
        </ng-template>
      </div>
      <app-sidebar-submenu *ngIf="sub.children?.length" [submenu]="sub"></app-sidebar-submenu>
    </li>
  </ul>
</div>